<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RiskBloX</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/bootstrap-multiselect.css" type="text/css"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
    
</head>

<body>
    <div id="container">
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-5">
            <header class="navbar-brand h1 ms-4"><img src="../images/riskblox-logo.png" width="45" height="40"></i> RiskBloX</header>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#toggleMenu" aria-controls="toggleMenu" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="toggleMenu">
                <ul class="navbar-nav nav me-auto text-center">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="start.html">Mitigate</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://attack.mitre.org/" target="_blank">MITRE ATT&CK</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://mitre-attack.github.io/attack-navigator/" target="_blank">MITRE ATT&CK Navigator</a>
                    </li>
                </ul>
                <ul class="navbar-nav nav ms-auto text-center">
                    <li class="nav-tem">
                        <a href="https://riskblox.auth.eu-west-1.amazoncognito.com/logout?client_id=3kr61qq6dpfs0c87t322m3ojth&logout_uri=https://riskblox.2t-security.co.uk/html/sign-out" class="badge badge-pill badge-light">
                            <i class="fas fa-sign-out-alt fa-2x"></i>
                            Sign Out
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="https://github.com/ReadyElbow/RiskBloX" target="_blank" class="badge badge-pill badge-light">
                            <i class="fab fa-github fa-2x"></i> Website/API Repo
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="https://github.com/mitre-attack/attack-navigator" target="_blank" class="badge badge-pill badge-light">
                            <i class="fab fa-github fa-2x"></i> Navigator Repo
                        </a>
                    </li>
                </ul>     
            </div>
        </nav>
    </div>

    <div id="domainDiv" class="container">
        <div class="row text-center">
            <div class="col-md-4 offset-md-4">
                <div class="card mb-5 h-100">
                    <div class="card-body">
                        <h5 class="card-title">Domain</h5>
                        <p class="card-text">
                            Which domain of technqiues would you like to filter for? Enterprise, Mobile or Industrial Control Systems?
                        </p>
                        <select class="form-select form-select-lg mb-3" id="domainChoice" aria-label=".form-select-lg example">
                            <option value="enterprise_attack" selected>Enterprise</option>
                            <option value="mobile_attack">Mobile</option>
                            <option value="ics_attack">Industrial Control Systems</option>
                        </select>
                        <button class="btn btn-primary" id="domainSubmit" onclick="addPost()" type="submit">Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div hidden class="container-fluid" id="additionalFilters">
        <div class="row mb-5 text-center">
            <h2 id="additionalFilterTitle">Additional Filters</h2>
            <div class="col-md-3">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Threat Groups</h5>
                        <p class="card-text">
                            Which Threat Groups would you like to include?
                        </p>
                        <select class="form-select form-select-lg mb-3" id="groupsList" multiple="multiple" aria-label=".form-select-lg example"></select>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Tactics</h5>
                        <p class="card-text">
                            What MITRE Tactics would you like to include?
                        </p>
                        <select class="form-select form-select-lg mb-3" id="tacticsList" multiple="multiple" aria-label=".form-select-lg example"></select>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Platforms</h5>
                        <p class="card-text">
                            What Platforms would you like to include?
                        </p>
                        <select class="form-select form-select-sm mb-3" id="platformsList" multiple="multiple" aria-label=".form-select-lg example"></select>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Malware</h5>
                        <p class="card-text">
                            What Malware/Software would you like to include?
                        </p>
                        <select class="form-select form-select-lg mb-3" id="malwareList" multiple="multiple" aria-label=".form-select-lg example"></select>
                    </div>
                </div>
            </div>
        </div>


        <div class="row">
            <div class="col-md-2 offset-md-5">
                <!-- (Disbabled temporarily) -->
                <!-- <div class="form-check mb-3">
                    <label class="form-check-label" for="includeSubTech">Include Sub-Techniques?</label>
                    <input class="form-check-input" value="" type="checkbox" id="includeSubTech" disabled>
                </div> -->

                <div class="form-check mb-3">
                    <label class="form-check-label" for="includeNonMappedT">Include Techniques not associated with Threat Groups/Malware?</label>
                    <input class="form-check-input" value="" type="checkbox" id="includeNonMappedT" checked>
                </div>
            
                <div class="text-center">
                    <label class="form-check-label" for="tolerance">
                        Define your Threat Tolerance
                        <a data-bs-toggle="modal" data-bs-target="#toleranceModal"><i class="fas fa-question-circle"></i></a>
                    </label>
                    <select id="tolerance" class="form-select form-select-sm mb-5" aria-label=".form-select-sm example">
                        <option value="Low">Low</option>
                        <option selected value="Medium">Medium</option>
                        <option value="High">High</option>
                    </select>
                    <button class="btn btn-primary" id="submitALlFilters" type="submit" onclick="redirect()">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex justify-content-center mt-4">
        <div hidden class="spinner-border" id="loading" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>
  
  <!-- Modal -->
    <div class="modal fade" id="toleranceModal" tabindex="-1" aria-labelledby="toleranceModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="toleranceModalLabel">Mitigation Tolerance Explanation</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-6 ">
                                <button class="btn btn-primary" onclick="update(high)">High</button>
                                <button class="btn btn-primary" onclick="update(medium)">Medium</button>
                                <button class="btn btn-primary" onclick="update(low)">Low</button>
                                <div id="toleranceGraph"></div>
                            </div>
                            <div class="col-md-6 align-items-center justify-content-center">
                                <p>
                                    Mitigation Tolerance Level is used to adjust how the Technique Score is calculated and is (currently) based off Positive Impact and Implementation Confidence Level.
                                </p>
                                <p>
                                    The equation will be defined by taking the ⅀ (Positive Impact levels) and the equation input will be the ⅀(Positive Impact * Implementation Confidence). If all mitigations are implemented with 100%, confidence then the output score will be 100.
                                </p>
                                <p>
                                    Two additional customization options are available because of how the calculation is achieved. In the case where the average Positive Impact level is too low (signifying that the suggested mitigations won't mitigate that attack technique sufficently), the total score of 100 should not be achievable otherwise you will have a defensive coverage that will provide a false image.
                                    To overcome this, you can define a threshold level (average Positive Impact) and a score limit that will be applied when the threshold level is breached.
                                </p>
                                <label class="form-check-label" for="impactThreshold">Positive Impact Threshold</label>
                                <select class="form-select form-select-lg mb-3" id="impactThreshold" aria-label=".form-select-lg example">
                                    <option value="0">0</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5" selected>5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10</option>
                                </select>
                                <label class="form-check-label" for="scoreLimit">Score Limit</label>
                                <select class="form-select form-select-lg mb-3" id="scoreLimit" aria-label=".form-select-lg example">
                                    <option value="0">0</option>
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="40">40</option>
                                    <option value="50" selected>50</option>
                                    <option value="60">60</option>
                                    <option value="70">70</option>
                                    <option value="80">80</option>
                                    <option value="90">90</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="../scripts/userAuth.js"></script>
    <script src="https://d3js.org/d3.v4.js"></script>
    <script type="text/javascript" src="../scripts/filter.js"></script>
    <script type="text/javascript" src="../scripts/environment.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="../scripts/bootstrap-multiselect.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" src="../scripts/pako.min.js"></script>
</body>
</html>